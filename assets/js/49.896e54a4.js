(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{445:function(s,t,n){"use strict";n.r(t);var a=n(56),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h4",{attrs:{id:"_1-linux的启动等级"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-linux的启动等级"}},[s._v("#")]),s._v(" 1. linux的启动等级")]),s._v(" "),n("p",[s._v("0 关机模式\n1 单用户模式\n2 无网络多用户模式\n3 有网络多用户模式，如果没网络和2一样。\n4.系统保留，未使用\n5.GUI图形界面\n6.重启模式，默认不能是这个级别，否则就会无限循环重启")]),s._v(" "),n("ul",[n("li",[n("em",[s._v("正常默认就是3了, 命令行模式，有桌面的，应该默认是5.")])]),s._v(" "),n("li",[n("em",[s._v("关机就可以终端输入init 0，重启就init 6")])])]),s._v(" "),n("p",[s._v("7.默认级别在centos7之前是/etc/inittab文件设置的，之后就由systemctl接管了")]),s._v(" "),n("ul",[n("li",[s._v("查看默认运行级别的方式为:")])]),s._v(" "),n("blockquote",[n("p",[s._v("systemctl get-default")])]),s._v(" "),n("ul",[n("li",[s._v("设置默认运行级别的方式:")])]),s._v(" "),n("blockquote",[n("p",[s._v("systemctl set-default TARGET.target")])]),s._v(" "),n("p",[s._v("*级别分别对应如下: *")]),s._v(" "),n("ul",[n("li",[n("blockquote",[n("p",[s._v("shutdown.target")])])]),s._v(" "),n("li",[n("blockquote",[n("p",[s._v("emergency.target")])])]),s._v(" "),n("li",[n("blockquote",[n("p",[s._v("rescure.target")])])]),s._v(" "),n("li",[n("blockquote",[n("p",[s._v("multi-user.target")])])]),s._v(" "),n("li",[n("blockquote",[n("p",[s._v("无")])])]),s._v(" "),n("li",[n("blockquote",[n("p",[s._v("graphical.target")])])]),s._v(" "),n("li",[n("blockquote",[n("p",[s._v("无")])])])]),s._v(" "),n("h4",{attrs:{id:"_2-每个等级-系统初始化运行了哪些脚本呢"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-每个等级-系统初始化运行了哪些脚本呢"}},[s._v("#")]),s._v(" 2. 每个等级，系统初始化运行了哪些脚本呢")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("/etc/init.d/ 目录是个软连接 实际是/etc/rc.d/init.d")])]),s._v(" "),n("li",[n("p",[s._v("/etc/rc1.d/")])]),s._v(" "),n("li",[n("p",[s._v("/etc/rc2.d/")])]),s._v(" "),n("li",[n("p",[s._v("/etc/rc3.d/")])]),s._v(" "),n("li",[n("p",[s._v("/etc/rc4.d/")])]),s._v(" "),n("li",[n("p",[s._v("/etc/rc5.d/")])]),s._v(" "),n("li",[n("p",[s._v("/etc/rc6.d/ 以上6个目录也都是软连接，实际是/etc/rc.d/目录下的")])]),s._v(" "),n("li",[n("p",[n("em",[s._v("最终就是/etc/rc.d/init.d/ 和/etc/rc.d/rcX.d/目录了")])])]),s._v(" "),n("li",[n("p",[n("em",[s._v("但是rcX.d/目录下的文件实质也是软连接，指向/etc/rc.d/init.d/目录下的脚本")])])])]),s._v(" "),n("h4",{attrs:{id:"_3-添加开机启动项-chkconfig"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加开机启动项-chkconfig"}},[s._v("#")]),s._v(" 3. 添加开机启动项(chkconfig)")]),s._v(" "),n("ul",[n("li",[s._v("经过之前的分析，实际上就是/etc/rc.d/init.d 目录下的东东，分析发现 都是shell脚本")]),s._v(" "),n("li",[s._v("脚本 按自己的操作写就ok")]),s._v(" "),n("li",[s._v("比如你写一个nginx自启动的脚本/etc/rc.d/init.d/nginx")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#! /bin/bash")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#chkconfig: 2345 80 90")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#description:auto_run")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /etc/init.d/functions\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"start"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    /usr/local/openresty/nginx/sbin/nginx\n    "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stop"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    /usr/local/openresty/nginx/sbin/nginx -s stop\n    "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'reload'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    /usr/local/openresty/nginx/sbin/nginx -s reload\n    "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sh nginx start|stop|reload"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("chmod +x nginx")])]),s._v(" "),n("li",[n("p",[s._v("chkconfig --add nginx (老写法：chkconfig nginx on)")])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("这样在对应等级rcX.d/目录下就会生成对应的链接，K开头脚本这个服务关闭，S开头的脚本是这个服务要开启.")])])]),s._v(" "),n("li",[n("p",[s._v("每个添加的自启动脚本必须要有2行注释：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#chkconfig: 2345 80 90")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#description:nginx_test 可以随便写描述")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("centos7 开头这么加也可以")])])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### BEGIN INIT INFO")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Provides:          php-fpm")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Required-Start:    $remote_fs $network")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Required-Stop:     $remote_fs $network")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Default-Start:     2 3 4 5")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Default-Stop:      0 1 6")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Short-Description: starts php-fpm")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Description:       starts the PHP FastCGI Process Manager daemon")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### END INIT INFO")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ul",[n("li",[s._v("解释下: 2345表示四个启动等级可以需要运行nginx服务; 在rc2|3|4|5.d目录下生成S"),n("strong",[s._v("80")]),s._v("nginx脚本，rc0|6.d目录下生成K"),n("strong",[s._v("90")]),s._v("nginx脚本都指向/etc/rc.d/init.d/nginx脚本（80，90为了标识脚本含义是开启还是关闭，虽然脚本内容一样，但是"),n("strong",[s._v("K开头执行时加参数 stop，S开头的执行时加参数 start")]),s._v("）")])]),s._v(" "),n("h4",{attrs:{id:"_4-在rc-local文件中添加启动项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-在rc-local文件中添加启动项"}},[s._v("#")]),s._v(" 4. 在rc.local文件中添加启动项")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("/etc/rc.d/init.d/rc.local 这个是init.d--\x3e rc.d 执行或之后执行的脚本，通常是用户自己定义的一些开机启动任务.")])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("下次总结一下Centos6的启动顺序")])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);